<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Stage 1 - Secure production server | Docker and small scale production ready apps</title>
    <meta name="description" content="As a developer you want to setup your solution for both development and production">
    
    
    <link rel="preload" href="/may14/assets/css/0.styles.67ed0360.css" as="style"><link rel="preload" href="/may14/assets/js/app.e3ae97d2.js" as="script"><link rel="preload" href="/may14/assets/js/3.231c2442.js" as="script"><link rel="prefetch" href="/may14/assets/js/10.8aa34345.js"><link rel="prefetch" href="/may14/assets/js/11.c7b0931a.js"><link rel="prefetch" href="/may14/assets/js/12.a211795f.js"><link rel="prefetch" href="/may14/assets/js/13.44b477ad.js"><link rel="prefetch" href="/may14/assets/js/2.deead8d0.js"><link rel="prefetch" href="/may14/assets/js/4.c1874e43.js"><link rel="prefetch" href="/may14/assets/js/5.a9a5104f.js"><link rel="prefetch" href="/may14/assets/js/6.63edfdf6.js"><link rel="prefetch" href="/may14/assets/js/7.8835d2d4.js"><link rel="prefetch" href="/may14/assets/js/8.140a8825.js"><link rel="prefetch" href="/may14/assets/js/9.cb0d3982.js">
    <link rel="stylesheet" href="/may14/assets/css/0.styles.67ed0360.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/may14/" class="home-link router-link-active"><!----> <span class="site-name">Docker and small scale production ready apps</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/may14/" class="nav-link">Home</a></div><div class="nav-item"><a href="/may14/stage1/" class="nav-link router-link-exact-active router-link-active">Stage1</a></div><div class="nav-item"><a href="/may14/stage2/" class="nav-link">Stage2</a></div><div class="nav-item"><a href="/may14/stage3/" class="nav-link">Stage3</a></div><div class="nav-item"><a href="/may14/certbot/" class="nav-link">Certbot</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/may14/" class="nav-link">Home</a></div><div class="nav-item"><a href="/may14/stage1/" class="nav-link router-link-exact-active router-link-active">Stage1</a></div><div class="nav-item"><a href="/may14/stage2/" class="nav-link">Stage2</a></div><div class="nav-item"><a href="/may14/stage3/" class="nav-link">Stage3</a></div><div class="nav-item"><a href="/may14/certbot/" class="nav-link">Certbot</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>Project</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Stage1</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/may14/stage1/" class="active sidebar-link">Stage 1 - Secure production server</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/may14/stage1/#workshop-instructions" class="sidebar-link">Workshop Instructions</a></li></ul></li><li><a href="/may14/stage1/server.html" class="sidebar-link">Server setup</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/may14/stage1/server.html#how-to-generate-a-ssh-key" class="sidebar-link">How to generate a SSH Key</a></li><li class="sidebar-sub-header"><a href="/may14/stage1/server.html#place-your-private-public-key-files" class="sidebar-link">Place your private public key files</a></li><li class="sidebar-sub-header"><a href="/may14/stage1/server.html#digital-ocean-server-setup" class="sidebar-link">Digital Ocean server setup</a></li><li class="sidebar-sub-header"><a href="/may14/stage1/server.html#first-log-on" class="sidebar-link">First log on</a></li><li class="sidebar-sub-header"><a href="/may14/stage1/server.html#prepare-the-system" class="sidebar-link">Prepare the system.</a></li><li class="sidebar-sub-header"><a href="/may14/stage1/server.html#securing-ssh-access-to-the-server" class="sidebar-link">Securing ssh access to the server</a></li><li class="sidebar-sub-header"><a href="/may14/stage1/server.html#firewall" class="sidebar-link">Firewall</a></li><li class="sidebar-sub-header"><a href="/may14/stage1/server.html#a-way-to-generate-strong-passwords" class="sidebar-link">A way to generate strong passwords</a></li></ul></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Stage2</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Stage3</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Certbot</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="stage-1-secure-production-server"><a href="#stage-1-secure-production-server" aria-hidden="true" class="header-anchor">#</a> Stage 1 - Secure production server</h1> <blockquote><p>To deliver an application you need a secure server</p></blockquote> <p>You will be hacked. All the time.  Every server is under constant attack.  They are
looking to steal data and they want your computational resources. They want your machine
to stage attacks on other servers.</p> <p>Yet you want to focus on developing your application.  How can you get your app onto prod in a secure way?
This stage 1 recipe will solve 95% of your problems which is good enough for most small scale applications.
This recipe sets up our server in a way that makes it difficult, not impossible, for the hacker.
Difficult is good enough because hackers don't want to spend a lot of time on systems that have low value.
If you need to protect information then you're going to need to go beyond this recipe.</p> <p>Secure server</p> <ol><li><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAtdJREFUOBGVlU1sTFEUx//vzbTTllELo9JYSBG1UbGR+G5ZCBKxEIRMRNPpTkKFTauviaYhIRERHw2KSpEmFkisWiK1IyERJCyLMZEQQqcfb/zum7wxb8wkNZP77r3n/M//nXPuPedZKvVzNBvVMoXUpIz2McKy1adfGlZEL+XoWzFT6x+ho5mYHsC4BZKlcpWWpS8eLqO5yMvZv0Xeq0ldhfhnPkeQsF0LVQnQ1npN4UlGt5hHNKaUKthNKoZ3a9DvZTQieYzHCZ3QB5/0L6GjRSrTPRQ1+NSmz7qty5rwgYE5AXKedkN+GnkS1A48fW8wWUITZkgPGPUa1xaULwIEpTYdalCVHuH5OyLZZsK3PaylZvK2jje1TZvM0Wb8rMCBg56tTd752TqmagQJyIY0qrulnAnIu7QRy7PEN0OdGsS7Ifathsuc2XKSW8+4WTJn+Wzd4Msgs4mlAyJhKWwFR6UabJTmnqUBPMu3K7p2VIdXV/DovNo1kMNksDUcITXaLOKAkoBSHqBdi3n3ghzYXzica0TXwA3i2QVf7M3G1nC4iptDcQPKsNbypj4dVTQnN+uwLoJ8DVlPTl64sBSyCfUGXtZAEvP0X7nM0ifN0nFv70AVJcQMxxbVoUIOb29sDYd03SaEYdyNMFZ5ynPkYkxHWG9Sl/Yw96CbA66FC5L2MIUPF1vDwU0JaSVFHtF2MHXUyoCeE9hT/aD4PuJbL8AKRhx/szkuJDNVU61TRJqmDLttndR3KC4RcpPma2cO36n7hNHKvpkTHc3JCxe12JibMgUHXMHSC2sJ79n6H9Wyguge5pde8eYwocMEfKfkRTdh1moXzzOkI0n5FTQHPwzTvqqgsbTBOyxX/axHWKc4KIt/DP1q8pVtX66e6DeHVbR9+aTBBltPfschSqK2yKlpsOZGvEE+jQbrk5rZfAKmaE/lNFJX+yGZZPQjM/X7Cn3RT8AfwjnZAnbGflYAAAAASUVORK5CYII=" alt="checked" title="checked"> No SSH access via password (public key cryptography only)</li> <li><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAtdJREFUOBGVlU1sTFEUx//vzbTTllELo9JYSBG1UbGR+G5ZCBKxEIRMRNPpTkKFTauviaYhIRERHw2KSpEmFkisWiK1IyERJCyLMZEQQqcfb/zum7wxb8wkNZP77r3n/M//nXPuPedZKvVzNBvVMoXUpIz2McKy1adfGlZEL+XoWzFT6x+ho5mYHsC4BZKlcpWWpS8eLqO5yMvZv0Xeq0ldhfhnPkeQsF0LVQnQ1npN4UlGt5hHNKaUKthNKoZ3a9DvZTQieYzHCZ3QB5/0L6GjRSrTPRQ1+NSmz7qty5rwgYE5AXKedkN+GnkS1A48fW8wWUITZkgPGPUa1xaULwIEpTYdalCVHuH5OyLZZsK3PaylZvK2jje1TZvM0Wb8rMCBg56tTd752TqmagQJyIY0qrulnAnIu7QRy7PEN0OdGsS7Ifathsuc2XKSW8+4WTJn+Wzd4Msgs4mlAyJhKWwFR6UabJTmnqUBPMu3K7p2VIdXV/DovNo1kMNksDUcITXaLOKAkoBSHqBdi3n3ghzYXzica0TXwA3i2QVf7M3G1nC4iptDcQPKsNbypj4dVTQnN+uwLoJ8DVlPTl64sBSyCfUGXtZAEvP0X7nM0ifN0nFv70AVJcQMxxbVoUIOb29sDYd03SaEYdyNMFZ5ynPkYkxHWG9Sl/Yw96CbA66FC5L2MIUPF1vDwU0JaSVFHtF2MHXUyoCeE9hT/aD4PuJbL8AKRhx/szkuJDNVU61TRJqmDLttndR3KC4RcpPma2cO36n7hNHKvpkTHc3JCxe12JibMgUHXMHSC2sJ79n6H9Wyguge5pde8eYwocMEfKfkRTdh1moXzzOkI0n5FTQHPwzTvqqgsbTBOyxX/axHWKc4KIt/DP1q8pVtX66e6DeHVbR9+aTBBltPfschSqK2yKlpsOZGvEE+jQbrk5rZfAKmaE/lNFJX+yGZZPQjM/X7Cn3RT8AfwjnZAnbGflYAAAAASUVORK5CYII=" alt="checked" title="checked"> No root user SSH access</li> <li><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAtdJREFUOBGVlU1sTFEUx//vzbTTllELo9JYSBG1UbGR+G5ZCBKxEIRMRNPpTkKFTauviaYhIRERHw2KSpEmFkisWiK1IyERJCyLMZEQQqcfb/zum7wxb8wkNZP77r3n/M//nXPuPedZKvVzNBvVMoXUpIz2McKy1adfGlZEL+XoWzFT6x+ho5mYHsC4BZKlcpWWpS8eLqO5yMvZv0Xeq0ldhfhnPkeQsF0LVQnQ1npN4UlGt5hHNKaUKthNKoZ3a9DvZTQieYzHCZ3QB5/0L6GjRSrTPRQ1+NSmz7qty5rwgYE5AXKedkN+GnkS1A48fW8wWUITZkgPGPUa1xaULwIEpTYdalCVHuH5OyLZZsK3PaylZvK2jje1TZvM0Wb8rMCBg56tTd752TqmagQJyIY0qrulnAnIu7QRy7PEN0OdGsS7Ifathsuc2XKSW8+4WTJn+Wzd4Msgs4mlAyJhKWwFR6UabJTmnqUBPMu3K7p2VIdXV/DovNo1kMNksDUcITXaLOKAkoBSHqBdi3n3ghzYXzica0TXwA3i2QVf7M3G1nC4iptDcQPKsNbypj4dVTQnN+uwLoJ8DVlPTl64sBSyCfUGXtZAEvP0X7nM0ifN0nFv70AVJcQMxxbVoUIOb29sDYd03SaEYdyNMFZ5ynPkYkxHWG9Sl/Yw96CbA66FC5L2MIUPF1vDwU0JaSVFHtF2MHXUyoCeE9hT/aD4PuJbL8AKRhx/szkuJDNVU61TRJqmDLttndR3KC4RcpPma2cO36n7hNHKvpkTHc3JCxe12JibMgUHXMHSC2sJ79n6H9Wyguge5pde8eYwocMEfKfkRTdh1moXzzOkI0n5FTQHPwzTvqqgsbTBOyxX/axHWKc4KIt/DP1q8pVtX66e6DeHVbR9+aTBBltPfschSqK2yKlpsOZGvEE+jQbrk5rZfAKmaE/lNFJX+yGZZPQjM/X7Cn3RT8AfwjnZAnbGflYAAAAASUVORK5CYII=" alt="checked" title="checked"> SSH access via non-standard port</li> <li><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAtdJREFUOBGVlU1sTFEUx//vzbTTllELo9JYSBG1UbGR+G5ZCBKxEIRMRNPpTkKFTauviaYhIRERHw2KSpEmFkisWiK1IyERJCyLMZEQQqcfb/zum7wxb8wkNZP77r3n/M//nXPuPedZKvVzNBvVMoXUpIz2McKy1adfGlZEL+XoWzFT6x+ho5mYHsC4BZKlcpWWpS8eLqO5yMvZv0Xeq0ldhfhnPkeQsF0LVQnQ1npN4UlGt5hHNKaUKthNKoZ3a9DvZTQieYzHCZ3QB5/0L6GjRSrTPRQ1+NSmz7qty5rwgYE5AXKedkN+GnkS1A48fW8wWUITZkgPGPUa1xaULwIEpTYdalCVHuH5OyLZZsK3PaylZvK2jje1TZvM0Wb8rMCBg56tTd752TqmagQJyIY0qrulnAnIu7QRy7PEN0OdGsS7Ifathsuc2XKSW8+4WTJn+Wzd4Msgs4mlAyJhKWwFR6UabJTmnqUBPMu3K7p2VIdXV/DovNo1kMNksDUcITXaLOKAkoBSHqBdi3n3ghzYXzica0TXwA3i2QVf7M3G1nC4iptDcQPKsNbypj4dVTQnN+uwLoJ8DVlPTl64sBSyCfUGXtZAEvP0X7nM0ifN0nFv70AVJcQMxxbVoUIOb29sDYd03SaEYdyNMFZ5ynPkYkxHWG9Sl/Yw96CbA66FC5L2MIUPF1vDwU0JaSVFHtF2MHXUyoCeE9hT/aD4PuJbL8AKRhx/szkuJDNVU61TRJqmDLttndR3KC4RcpPma2cO36n7hNHKvpkTHc3JCxe12JibMgUHXMHSC2sJ79n6H9Wyguge5pde8eYwocMEfKfkRTdh1moXzzOkI0n5FTQHPwzTvqqgsbTBOyxX/axHWKc4KIt/DP1q8pVtX66e6DeHVbR9+aTBBltPfschSqK2yKlpsOZGvEE+jQbrk5rZfAKmaE/lNFJX+yGZZPQjM/X7Cn3RT8AfwjnZAnbGflYAAAAASUVORK5CYII=" alt="checked" title="checked"> User account with user name that is unique and difficult to quess</li> <li><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAtdJREFUOBGVlU1sTFEUx//vzbTTllELo9JYSBG1UbGR+G5ZCBKxEIRMRNPpTkKFTauviaYhIRERHw2KSpEmFkisWiK1IyERJCyLMZEQQqcfb/zum7wxb8wkNZP77r3n/M//nXPuPedZKvVzNBvVMoXUpIz2McKy1adfGlZEL+XoWzFT6x+ho5mYHsC4BZKlcpWWpS8eLqO5yMvZv0Xeq0ldhfhnPkeQsF0LVQnQ1npN4UlGt5hHNKaUKthNKoZ3a9DvZTQieYzHCZ3QB5/0L6GjRSrTPRQ1+NSmz7qty5rwgYE5AXKedkN+GnkS1A48fW8wWUITZkgPGPUa1xaULwIEpTYdalCVHuH5OyLZZsK3PaylZvK2jje1TZvM0Wb8rMCBg56tTd752TqmagQJyIY0qrulnAnIu7QRy7PEN0OdGsS7Ifathsuc2XKSW8+4WTJn+Wzd4Msgs4mlAyJhKWwFR6UabJTmnqUBPMu3K7p2VIdXV/DovNo1kMNksDUcITXaLOKAkoBSHqBdi3n3ghzYXzica0TXwA3i2QVf7M3G1nC4iptDcQPKsNbypj4dVTQnN+uwLoJ8DVlPTl64sBSyCfUGXtZAEvP0X7nM0ifN0nFv70AVJcQMxxbVoUIOb29sDYd03SaEYdyNMFZ5ynPkYkxHWG9Sl/Yw96CbA66FC5L2MIUPF1vDwU0JaSVFHtF2MHXUyoCeE9hT/aD4PuJbL8AKRhx/szkuJDNVU61TRJqmDLttndR3KC4RcpPma2cO36n7hNHKvpkTHc3JCxe12JibMgUHXMHSC2sJ79n6H9Wyguge5pde8eYwocMEfKfkRTdh1moXzzOkI0n5FTQHPwzTvqqgsbTBOyxX/axHWKc4KIt/DP1q8pVtX66e6DeHVbR9+aTBBltPfschSqK2yKlpsOZGvEE+jQbrk5rZfAKmaE/lNFJX+yGZZPQjM/X7Cn3RT8AfwjnZAnbGflYAAAAASUVORK5CYII=" alt="checked" title="checked"> User has sudo privileges</li> <li><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAtdJREFUOBGVlU1sTFEUx//vzbTTllELo9JYSBG1UbGR+G5ZCBKxEIRMRNPpTkKFTauviaYhIRERHw2KSpEmFkisWiK1IyERJCyLMZEQQqcfb/zum7wxb8wkNZP77r3n/M//nXPuPedZKvVzNBvVMoXUpIz2McKy1adfGlZEL+XoWzFT6x+ho5mYHsC4BZKlcpWWpS8eLqO5yMvZv0Xeq0ldhfhnPkeQsF0LVQnQ1npN4UlGt5hHNKaUKthNKoZ3a9DvZTQieYzHCZ3QB5/0L6GjRSrTPRQ1+NSmz7qty5rwgYE5AXKedkN+GnkS1A48fW8wWUITZkgPGPUa1xaULwIEpTYdalCVHuH5OyLZZsK3PaylZvK2jje1TZvM0Wb8rMCBg56tTd752TqmagQJyIY0qrulnAnIu7QRy7PEN0OdGsS7Ifathsuc2XKSW8+4WTJn+Wzd4Msgs4mlAyJhKWwFR6UabJTmnqUBPMu3K7p2VIdXV/DovNo1kMNksDUcITXaLOKAkoBSHqBdi3n3ghzYXzica0TXwA3i2QVf7M3G1nC4iptDcQPKsNbypj4dVTQnN+uwLoJ8DVlPTl64sBSyCfUGXtZAEvP0X7nM0ifN0nFv70AVJcQMxxbVoUIOb29sDYd03SaEYdyNMFZ5ynPkYkxHWG9Sl/Yw96CbA66FC5L2MIUPF1vDwU0JaSVFHtF2MHXUyoCeE9hT/aD4PuJbL8AKRhx/szkuJDNVU61TRJqmDLttndR3KC4RcpPma2cO36n7hNHKvpkTHc3JCxe12JibMgUHXMHSC2sJ79n6H9Wyguge5pde8eYwocMEfKfkRTdh1moXzzOkI0n5FTQHPwzTvqqgsbTBOyxX/axHWKc4KIt/DP1q8pVtX66e6DeHVbR9+aTBBltPfschSqK2yKlpsOZGvEE+jQbrk5rZfAKmaE/lNFJX+yGZZPQjM/X7Cn3RT8AfwjnZAnbGflYAAAAASUVORK5CYII=" alt="checked" title="checked"> Firewall blocks all ports except 80 and 443 (and custom ssh)</li></ol> <h1 id="update"><a href="#update" aria-hidden="true" class="header-anchor">#</a> Update</h1> <p>The material in Stage 1 was presented on May 14, 2019.  Afterwards, Jonathan composed a really nice tidy script that
accomplishes all the tasks of stage one.   <a href="https://github.com/jonathan-longe/basic-server" target="_blank" rel="noopener noreferrer">basic-server<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="workshop-instructions"><a href="#workshop-instructions" aria-hidden="true" class="header-anchor">#</a> Workshop Instructions</h2> <p>Log onto a newly created Debian based production server and follow the steps in <a href="/may14/stage1/server.html">server setup</a></p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/may14/" class="prev router-link-active">
          May 14 2019 Workshop
        </a></span> <span class="next"><a href="/may14/stage1/server.html">
          Server setup
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/may14/assets/js/app.e3ae97d2.js" defer></script><script src="/may14/assets/js/3.231c2442.js" defer></script>
  </body>
</html>
